# üß© Telegram Bot ‚Äî –ö–≤–µ—Å—Ç —Å Excel

**Telegram-–±–æ—Ç –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∫–≤–µ—Å—Ç–æ–≤, –≤–∏–∫—Ç–æ—Ä–∏–Ω –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä.**  
–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –æ–Ω–ª–∞–π–Ω-–∫–≤–µ—Å—Ç–æ–≤ –∏ –∏–≥—Ä —Å –¥—Ä—É–∑—å—è–º–∏.  
–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥.
- –í—ã–¥–∞—á–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –∏ –ø—Ä–æ–ø—É—Å–∫–æ–º.
- –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
- –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Excel –¥–ª—è –≥–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.


## üìë –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–ú–µ—Ö–∞–Ω–∏–∫–∞ –∏–≥—Ä—ã](#–º–µ—Ö–∞–Ω–∏–∫–∞-–∏–≥—Ä—ã)
- [üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [‚öô –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [‚ñ∂ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞](#-–∑–∞–ø—É—Å–∫-–±–æ—Ç–∞)
- [‚úÖ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤](#-–∫–æ–º–∞–Ω–¥—ã-–¥–ª—è-–∏–≥—Ä–æ–∫–æ–≤)
- [üõ† –ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞](#-–∫–æ–º–∞–Ω–¥—ã-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
- [üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∞ –∫–æ–º–∞–Ω–¥](#-–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç-–∞–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∞-–∫–æ–º–∞–Ω–¥)
- [üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è](#-–ø—Ä–∏–º–µ—á–∞–Ω–∏—è)
- [‚úÖ –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ç–∏–Ω–≥](#-–∫–æ–Ω—Ç—Ä–∏–±—å—é—Ç–∏–Ω–≥)


## üéÆ –ú–µ—Ö–∞–Ω–∏–∫–∞ –∏–≥—Ä—ã

### üë§ **–ò–≥—Ä–æ–∫**
- –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `/register` –∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã.
- –ü–æ–ª—É—á–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ.  
- –ú–æ–∂–µ—Ç:
  - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–≤–µ—Ç—ã –≤ —á–∞—Ç (–±–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ (–∫–∞–∂–¥–∞—è —Å—Ç–æ–∏—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤).
  - –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –≤–æ–ø—Ä–æ—Å (–º–∏–Ω—É—Å 3 –±–∞–ª–ª–∞).
- –ü–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –±–æ—Ç —Å–æ–æ–±—â–∞–µ—Ç –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –∏–≥—Ä—ã.

### üõ† **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º:
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏–≥—Ä—É (`/startgame`) ‚Äî –≤–æ–ø—Ä–æ—Å—ã —Ä–∞—Å—Å—ã–ª–∞—é—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º.
  - –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç (`/stopgame`) ‚Äî –Ω–∞—á–∏—Å–ª—è–µ—Ç –±–æ–Ω—É—Å—ã –∑–∞ —Å–∫–æ—Ä–æ—Å—Ç—å.
  - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏–≥—Ä—É (`/resetgame`) ‚Äî –æ—á–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.
  - –î–µ–ª–∞–µ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏ (`/broadcast`) ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Å–µ–º.
  - –°–º–µ–Ω—è–µ—Ç –ª–∏–¥–µ—Ä–∞ –∫–æ–º–∞–Ω–¥—ã (`/changeleader`).
- –ê–¥–º–∏–Ω—Å–∫–∏–µ –ø—Ä–∞–≤–∞ –≤—ã–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `/setadmin <–ø–∞—Ä–æ–ª—å>`.
- –ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∏–≥—Ä—ã (`/stopgame`) –±–æ—Ç —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏—Å–ª—è–µ—Ç –±–æ–Ω—É—Å—ã –∑–∞ —Å–∫–æ—Ä–æ—Å—Ç—å:
    - 1 –º–µ—Å—Ç–æ: +3 –±–∞–ª–ª–∞
    - 2 –º–µ—Å—Ç–æ: +2 –±–∞–ª–ª–∞
    - 3 –º–µ—Å—Ç–æ: +1 –±–∞–ª–ª


---

## üìÇ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**
```
project/
‚îú‚îÄ‚îÄ main.py                 # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (TOKEN, –ø—É—Ç–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
‚îú‚îÄ‚îÄ excel_utils.py          # –†–∞–±–æ—Ç–∞ —Å Excel
‚îú‚îÄ‚îÄ keyboards.py            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è inline-–∫–Ω–æ–ø–æ–∫
‚îú‚îÄ‚îÄ state_manager.py        # –•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ user.py             # –õ–æ–≥–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ admin.py            # –õ–æ–≥–∏–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îú‚îÄ‚îÄ media/
‚îÇ   ‚îî‚îÄ‚îÄ QustData.xlsx       # –§–∞–π–ª —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md               # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
```

---

## ‚öô **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**
- Python 3.10+
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `requirements.txt`

---

## üõ† **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**

### üîë **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–¥–∞**
1. –í —Ñ–∞–π–ª–µ `config.py`:
    - –£–∫–∞–∂–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:
    ```python
    TOKEN = "–í–ê–®_–¢–û–ö–ï–ù"
    ```
    - –ó–∞–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
    ```python
    ADMIN_PASSWORD = "MySecret123"
    ```

### üìÑ **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Excel**
1. –í –ø–∞–ø–∫–µ `media/` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è `QustData.xlsx`.
2. –õ–∏—Å—Ç—ã:
   - **–£—á–∞—Å—Ç–Ω–∏–∫–∏:** –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏.
   - **–ë–∞–∑–∞:** –∑–∞–ø–æ–ª–Ω–∏—Ç—å:
     - `A1` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–≤–µ—Å—Ç–∞.
     - –í–æ–ø—Ä–æ—Å—ã (—Å—Ç—Ä–æ–∫–∏ 2), –ø–æ–¥—Å–∫–∞–∑–∫–∏, –∏—Ö —Å—Ç–æ–∏–º–æ—Å—Ç—å, –æ—Ç–≤–µ—Ç—ã (—Å—Ç—Ä–æ–∫–∞ "–û—Ç–≤–µ—Ç—ã").
3. –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–∏—Å—Ç **–£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—É—Å—Ç (–Ω–µ—Ç —Å—Ç–∞—Ä—ã—Ö –∏–≥—Ä–æ–∫–æ–≤)**.

---

## ‚ñ∂ **–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞**
```bash
python main.py
```

---

## ‚úÖ **–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤**
- `/start` ‚Äî –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º.
- `/register` ‚Äî –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É.
- `/rating` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–π—Ç–∏–Ω–≥.
- `/help` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥.

---

## üõ† **–ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
- `/setadmin <–ø–∞—Ä–æ–ª—å>` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞.
- `/startgame` ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É.
- `/stopgame` ‚Äî –∑–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É.
- `/resetgame` ‚Äî —Å–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É.
- `/broadcast <—Ç–µ–∫—Å—Ç>` ‚Äî —Å–¥–µ–ª–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É.
- `/changeleader <old_id> <new_id>` ‚Äî —Å–º–µ–Ω–∏—Ç—å –ª–∏–¥–µ—Ä–∞ –∫–æ–º–∞–Ω–¥—ã.

---

## üîß **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∞ –∫–æ–º–∞–Ω–¥**
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—Å–µ—Ö.
- –ü–æ—Å–ª–µ `/setadmin` –∞–¥–º–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–∏ –∫–æ–º–∞–Ω–¥—ã.
- –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥:
```python
await bot.set_my_commands(commands)
```

---

## üìå **–ü—Ä–∏–º–µ—á–∞–Ω–∏—è**
- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–æ–≤ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ Excel.
- –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —É–¥–∞–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã (—á–∞—Ç –æ—Å—Ç–∞—ë—Ç—Å—è —á–∏—Å—Ç—ã–º).

---

## ‚úÖ **–ö–æ–Ω—Ç—Ä–∏–±—å—é—Ç–∏–Ω–≥**
Pull requests –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è! –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –±–∞–≥ –∏–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–µ–∫—Ç ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ PR.

---
